nohup: ignoring input
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:108: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

['src/train.py', '--dataset', 'elec14', '--model_type', 'GRU4REC']
WARNING:tensorflow:From src/train.py:347: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From src/train.py:225: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From src/train.py:231: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From src/train.py:231: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-06-05 16:49:41.897470: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-06-05 16:49:41.931836: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2022-06-05 16:49:41.935961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560abc415420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-06-05 16:49:41.936008: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-06-05 16:49:41.939249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-06-05 16:49:42.082295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560abc159180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-06-05 16:49:42.082378: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA TITAN RTX, Compute Capability 7.5
2022-06-05 16:49:42.083575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA TITAN RTX major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:b1:00.0
2022-06-05 16:49:42.084046: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-06-05 16:49:42.085847: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-06-05 16:49:42.088653: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-06-05 16:49:42.089272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-06-05 16:49:42.092456: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-06-05 16:49:42.094283: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-06-05 16:49:42.099247: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-06-05 16:49:42.100525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2022-06-05 16:49:42.100577: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-06-05 16:49:42.101674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-06-05 16:49:42.101696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2022-06-05 16:49:42.101708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2022-06-05 16:49:42.103071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22301 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN RTX, pci bus id: 0000:b1:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:16: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:27: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:91: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:93: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:39: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From src/train.py:237: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From src/train.py:238: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

training begin
2022-06-05 16:49:48.522132: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
default_12
iter: 1000, train loss: 7.4977, valid recall: 0.066626, valid ndcg: 0.043987, valid hitrate: 0.124012
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:66: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

time interval: 0.5143 min
default_12
iter: 2000, train loss: 7.0416, valid recall: 0.064313, valid ndcg: 0.044157, valid hitrate: 0.123077
time interval: 1.0048 min
default_12
iter: 3000, train loss: 6.8701, valid recall: 0.066678, valid ndcg: 0.044781, valid hitrate: 0.125364
time interval: 1.5333 min
default_12
iter: 4000, train loss: 6.7240, valid recall: 0.064524, valid ndcg: 0.044361, valid hitrate: 0.123337
time interval: 2.0907 min
default_12
iter: 5000, train loss: 6.5927, valid recall: 0.065953, valid ndcg: 0.044029, valid hitrate: 0.124896
time interval: 2.6466 min
default_12
iter: 6000, train loss: 6.4594, valid recall: 0.065921, valid ndcg: 0.044455, valid hitrate: 0.125052
time interval: 3.2586 min
default_12
iter: 7000, train loss: 6.3402, valid recall: 0.063002, valid ndcg: 0.043295, valid hitrate: 0.121726
time interval: 3.9855 min
default_12
iter: 8000, train loss: 6.2223, valid recall: 0.062570, valid ndcg: 0.042391, valid hitrate: 0.121881
time interval: 4.7208 min
default_12
iter: 9000, train loss: 6.1066, valid recall: 0.062016, valid ndcg: 0.042140, valid hitrate: 0.121050
time interval: 5.4299 min
default_12
iter: 10000, train loss: 5.9896, valid recall: 0.060041, valid ndcg: 0.040534, valid hitrate: 0.118555
time interval: 6.1657 min
default_12
iter: 11000, train loss: 5.8756, valid recall: 0.059303, valid ndcg: 0.041023, valid hitrate: 0.117516
time interval: 6.8879 min
default_12
iter: 12000, train loss: 5.7769, valid recall: 0.058845, valid ndcg: 0.041027, valid hitrate: 0.118087
time interval: 7.5926 min
default_12
iter: 13000, train loss: 5.6682, valid recall: 0.057808, valid ndcg: 0.039944, valid hitrate: 0.115904
time interval: 8.3189 min
default_12
iter: 14000, train loss: 5.5715, valid recall: 0.056766, valid ndcg: 0.039494, valid hitrate: 0.114709
time interval: 9.0314 min
default_12
iter: 15000, train loss: 5.4829, valid recall: 0.056504, valid ndcg: 0.038617, valid hitrate: 0.113565
time interval: 9.7227 min
default_12
iter: 16000, train loss: 5.3807, valid recall: 0.054609, valid ndcg: 0.038447, valid hitrate: 0.111486
time interval: 10.3785 min
default_12
iter: 17000, train loss: 5.3093, valid recall: 0.053976, valid ndcg: 0.038068, valid hitrate: 0.109771
time interval: 11.0279 min
default_12
iter: 18000, train loss: 5.2201, valid recall: 0.052558, valid ndcg: 0.036414, valid hitrate: 0.108004
time interval: 11.6365 min
default_12
iter: 19000, train loss: 5.1458, valid recall: 0.052599, valid ndcg: 0.036332, valid hitrate: 0.107328
time interval: 12.2663 min
default_12
iter: 20000, train loss: 5.0591, valid recall: 0.051204, valid ndcg: 0.035521, valid hitrate: 0.105249
time interval: 12.9131 min
default_12
iter: 21000, train loss: 4.9943, valid recall: 0.051502, valid ndcg: 0.035754, valid hitrate: 0.105821
time interval: 13.5466 min
default_12
iter: 22000, train loss: 4.9090, valid recall: 0.049526, valid ndcg: 0.034693, valid hitrate: 0.102547
time interval: 14.1874 min
default_12
iter: 23000, train loss: 4.8450, valid recall: 0.050317, valid ndcg: 0.035290, valid hitrate: 0.103690
time interval: 14.8030 min
default_12
iter: 24000, train loss: 4.7785, valid recall: 0.049547, valid ndcg: 0.034759, valid hitrate: 0.102911
time interval: 15.4149 min
default_12
iter: 25000, train loss: 4.7231, valid recall: 0.048254, valid ndcg: 0.033389, valid hitrate: 0.099844
time interval: 16.0591 min
default_12
iter: 26000, train loss: 4.6506, valid recall: 0.048187, valid ndcg: 0.033410, valid hitrate: 0.100208
time interval: 16.7128 min
default_12
iter: 27000, train loss: 4.5988, valid recall: 0.047713, valid ndcg: 0.033348, valid hitrate: 0.098129
time interval: 17.3461 min
default_12
iter: 28000, train loss: 4.5368, valid recall: 0.046462, valid ndcg: 0.032265, valid hitrate: 0.095946
time interval: 17.9518 min
default_12
iter: 29000, train loss: 4.4917, valid recall: 0.046829, valid ndcg: 0.032448, valid hitrate: 0.096570
time interval: 18.5711 min
default_12
iter: 30000, train loss: 4.4299, valid recall: 0.044307, valid ndcg: 0.030713, valid hitrate: 0.092204
time interval: 19.2069 min
default_12
iter: 31000, train loss: 4.3907, valid recall: 0.046096, valid ndcg: 0.032044, valid hitrate: 0.095374
time interval: 19.7419 min
default_12
iter: 32000, train loss: 4.3364, valid recall: 0.044056, valid ndcg: 0.030706, valid hitrate: 0.092568
time interval: 20.2158 min
default_12
iter: 33000, train loss: 4.2807, valid recall: 0.044386, valid ndcg: 0.030804, valid hitrate: 0.092516
time interval: 20.6883 min
default_12
iter: 34000, train loss: 4.2364, valid recall: 0.043724, valid ndcg: 0.030054, valid hitrate: 0.090125
time interval: 21.1657 min
default_12
iter: 35000, train loss: 4.1884, valid recall: 0.043297, valid ndcg: 0.030237, valid hitrate: 0.090177
time interval: 21.6368 min
default_12
iter: 36000, train loss: 4.1510, valid recall: 0.043180, valid ndcg: 0.029832, valid hitrate: 0.089813
time interval: 22.1077 min
default_12
iter: 37000, train loss: 4.1137, valid recall: 0.043080, valid ndcg: 0.029390, valid hitrate: 0.089449
time interval: 22.5780 min
default_12
iter: 38000, train loss: 4.0805, valid recall: 0.042988, valid ndcg: 0.029661, valid hitrate: 0.089709
time interval: 23.0555 min
default_12
iter: 39000, train loss: 4.0317, valid recall: 0.042797, valid ndcg: 0.029572, valid hitrate: 0.089241
time interval: 23.5287 min
default_12
iter: 40000, train loss: 3.9808, valid recall: 0.041542, valid ndcg: 0.028105, valid hitrate: 0.086435
time interval: 24.0045 min
default_12
iter: 41000, train loss: 3.9711, valid recall: 0.042552, valid ndcg: 0.029308, valid hitrate: 0.088617
time interval: 24.4816 min
default_12
iter: 42000, train loss: 3.9219, valid recall: 0.041798, valid ndcg: 0.028460, valid hitrate: 0.087682
time interval: 24.9584 min
default_12
iter: 43000, train loss: 3.8868, valid recall: 0.042200, valid ndcg: 0.027966, valid hitrate: 0.086850
time interval: 25.4377 min
default_12
iter: 44000, train loss: 3.8650, valid recall: 0.041439, valid ndcg: 0.027974, valid hitrate: 0.085551
time interval: 25.9158 min
default_12
iter: 45000, train loss: 3.8175, valid recall: 0.040756, valid ndcg: 0.027474, valid hitrate: 0.084615
time interval: 26.3970 min
default_12
iter: 46000, train loss: 3.8017, valid recall: 0.039727, valid ndcg: 0.026621, valid hitrate: 0.082069
time interval: 26.8697 min
default_12
iter: 47000, train loss: 3.7634, valid recall: 0.040714, valid ndcg: 0.027161, valid hitrate: 0.083732
time interval: 27.3414 min
default_12
iter: 48000, train loss: 3.7218, valid recall: 0.040845, valid ndcg: 0.026996, valid hitrate: 0.084459
time interval: 27.8130 min
default_12
iter: 49000, train loss: 3.6909, valid recall: 0.040959, valid ndcg: 0.027676, valid hitrate: 0.085083
time interval: 28.3023 min
default_12
iter: 50000, train loss: 3.6755, valid recall: 0.040733, valid ndcg: 0.027085, valid hitrate: 0.084200
time interval: 28.7950 min
default_12
iter: 51000, train loss: 3.6411, valid recall: 0.039489, valid ndcg: 0.026664, valid hitrate: 0.081601
time interval: 29.2879 min
default_12
iter: 52000, train loss: 3.6231, valid recall: 0.039296, valid ndcg: 0.026510, valid hitrate: 0.081809
time interval: 29.7838 min
default_12
iter: 53000, train loss: 3.5979, valid recall: 0.037906, valid ndcg: 0.026388, valid hitrate: 0.079210
time interval: 30.2621 min
default_12
iter: 54000, train loss: 3.5968, valid recall: 0.038521, valid ndcg: 0.026105, valid hitrate: 0.079626
model restored from best_model/default_12/
valid recall: 0.066678, valid ndcg: 0.044781, valid hitrate: 0.125364, valid diversity: 0.000000
test recall: 0.068438, test ndcg: 0.046638, test hitrate: 0.128736, test diversity: 0.000000
