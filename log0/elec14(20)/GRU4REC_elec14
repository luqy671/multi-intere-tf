nohup: ignoring input
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:108: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

['src/train.py', '--model_type', 'GRU4REC', '--dataset', 'elec14']
WARNING:tensorflow:From src/train.py:347: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

DataSet: elec14 (20)
WARNING:tensorflow:From src/train.py:225: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From src/train.py:231: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From src/train.py:231: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-06-16 17:48:23.216919: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-06-16 17:48:23.266353: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2022-06-16 17:48:23.270490: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb38011680 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-06-16 17:48:23.270552: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-06-16 17:48:23.275394: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-06-16 17:48:23.492245: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb37d85450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-06-16 17:48:23.492306: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA TITAN RTX, Compute Capability 7.5
2022-06-16 17:48:23.493066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA TITAN RTX major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:1a:00.0
2022-06-16 17:48:23.493538: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-06-16 17:48:23.495100: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-06-16 17:48:23.497366: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-06-16 17:48:23.497835: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-06-16 17:48:23.500891: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-06-16 17:48:23.502454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-06-16 17:48:23.508290: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-06-16 17:48:23.509583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2022-06-16 17:48:23.509657: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-06-16 17:48:23.510752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-06-16 17:48:23.510782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2022-06-16 17:48:23.510794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2022-06-16 17:48:23.512020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22855 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN RTX, pci bus id: 0000:1a:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:16: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:27: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:91: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:93: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:39: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From src/train.py:237: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From src/train.py:238: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

training begin
2022-06-16 17:48:29.902390: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
default_0
iter: 1000, train loss: 7.4977, valid recall: 0.039994, valid ndcg: 0.034709, valid hitrate: 0.076351
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:66: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

time interval: 0.4884 min
default_0
iter: 2000, train loss: 7.0416, valid recall: 0.037696, valid ndcg: 0.034456, valid hitrate: 0.072973
time interval: 0.9377 min
default_0
iter: 3000, train loss: 6.8701, valid recall: 0.040526, valid ndcg: 0.035442, valid hitrate: 0.077339
time interval: 1.4184 min
default_0
iter: 4000, train loss: 6.7240, valid recall: 0.039906, valid ndcg: 0.035420, valid hitrate: 0.077131
time interval: 2.0240 min
default_0
iter: 5000, train loss: 6.5927, valid recall: 0.038744, valid ndcg: 0.034474, valid hitrate: 0.075832
time interval: 2.6615 min
default_0
iter: 6000, train loss: 6.4594, valid recall: 0.039241, valid ndcg: 0.035245, valid hitrate: 0.077183
time interval: 3.3821 min
default_0
iter: 7000, train loss: 6.3402, valid recall: 0.037784, valid ndcg: 0.034193, valid hitrate: 0.074636
time interval: 4.1476 min
default_0
iter: 8000, train loss: 6.2223, valid recall: 0.037406, valid ndcg: 0.033272, valid hitrate: 0.074428
time interval: 4.9123 min
default_0
iter: 9000, train loss: 6.1066, valid recall: 0.036681, valid ndcg: 0.032912, valid hitrate: 0.073493
time interval: 5.6671 min
default_0
iter: 10000, train loss: 5.9896, valid recall: 0.035216, valid ndcg: 0.031373, valid hitrate: 0.071310
time interval: 6.4131 min
default_0
iter: 11000, train loss: 5.8756, valid recall: 0.034826, valid ndcg: 0.031969, valid hitrate: 0.070894
time interval: 7.1806 min
default_0
iter: 12000, train loss: 5.7769, valid recall: 0.034406, valid ndcg: 0.031749, valid hitrate: 0.070426
time interval: 7.9404 min
default_0
iter: 13000, train loss: 5.6682, valid recall: 0.034806, valid ndcg: 0.031313, valid hitrate: 0.071206
time interval: 8.7084 min
default_0
iter: 14000, train loss: 5.5715, valid recall: 0.034487, valid ndcg: 0.031007, valid hitrate: 0.070842
time interval: 9.4624 min
default_0
iter: 15000, train loss: 5.4829, valid recall: 0.033553, valid ndcg: 0.030025, valid hitrate: 0.069023
time interval: 10.2292 min
default_0
iter: 16000, train loss: 5.3805, valid recall: 0.031785, valid ndcg: 0.029645, valid hitrate: 0.065800
time interval: 10.9970 min
default_0
iter: 17000, train loss: 5.3093, valid recall: 0.031909, valid ndcg: 0.029579, valid hitrate: 0.066528
time interval: 11.7505 min
default_0
iter: 18000, train loss: 5.2199, valid recall: 0.030176, valid ndcg: 0.027835, valid hitrate: 0.064033
time interval: 12.5017 min
default_0
iter: 19000, train loss: 5.1460, valid recall: 0.030288, valid ndcg: 0.027855, valid hitrate: 0.064137
time interval: 13.2559 min
default_0
iter: 20000, train loss: 5.0585, valid recall: 0.029382, valid ndcg: 0.027369, valid hitrate: 0.062474
time interval: 13.9341 min
default_0
iter: 21000, train loss: 4.9926, valid recall: 0.030510, valid ndcg: 0.027617, valid hitrate: 0.064241
time interval: 14.5863 min
default_0
iter: 22000, train loss: 4.9097, valid recall: 0.029387, valid ndcg: 0.026893, valid hitrate: 0.062370
time interval: 15.2562 min
default_0
iter: 23000, train loss: 4.8437, valid recall: 0.029921, valid ndcg: 0.027811, valid hitrate: 0.064189
time interval: 15.9082 min
default_0
iter: 24000, train loss: 4.7765, valid recall: 0.028827, valid ndcg: 0.027020, valid hitrate: 0.061746
time interval: 16.5244 min
default_0
iter: 25000, train loss: 4.7230, valid recall: 0.028929, valid ndcg: 0.026558, valid hitrate: 0.061279
time interval: 17.0056 min
default_0
iter: 26000, train loss: 4.6516, valid recall: 0.027488, valid ndcg: 0.025842, valid hitrate: 0.058888
time interval: 17.4899 min
default_0
iter: 27000, train loss: 4.5978, valid recall: 0.028747, valid ndcg: 0.026185, valid hitrate: 0.060447
time interval: 17.9682 min
default_0
iter: 28000, train loss: 4.5342, valid recall: 0.028335, valid ndcg: 0.025616, valid hitrate: 0.059407
time interval: 18.4546 min
default_0
iter: 29000, train loss: 4.4897, valid recall: 0.027172, valid ndcg: 0.024719, valid hitrate: 0.057692
time interval: 18.9290 min
default_0
iter: 30000, train loss: 4.4277, valid recall: 0.026188, valid ndcg: 0.024285, valid hitrate: 0.056289
time interval: 19.4135 min
default_0
iter: 31000, train loss: 4.3879, valid recall: 0.026619, valid ndcg: 0.024258, valid hitrate: 0.056705
time interval: 19.8648 min
default_0
iter: 32000, train loss: 4.3373, valid recall: 0.024986, valid ndcg: 0.023492, valid hitrate: 0.053898
time interval: 20.3007 min
default_0
iter: 33000, train loss: 4.2793, valid recall: 0.024777, valid ndcg: 0.023366, valid hitrate: 0.053326
time interval: 20.7387 min
default_0
iter: 34000, train loss: 4.2337, valid recall: 0.025044, valid ndcg: 0.022706, valid hitrate: 0.052547
time interval: 21.1836 min
default_0
iter: 35000, train loss: 4.1902, valid recall: 0.025142, valid ndcg: 0.023253, valid hitrate: 0.052651
time interval: 21.6246 min
default_0
iter: 36000, train loss: 4.1483, valid recall: 0.023655, valid ndcg: 0.022487, valid hitrate: 0.050780
time interval: 22.0658 min
default_0
iter: 37000, train loss: 4.1125, valid recall: 0.023337, valid ndcg: 0.021735, valid hitrate: 0.050520
time interval: 22.5117 min
default_0
iter: 38000, train loss: 4.0812, valid recall: 0.024311, valid ndcg: 0.021828, valid hitrate: 0.051455
time interval: 22.9596 min
default_0
iter: 39000, train loss: 4.0322, valid recall: 0.024201, valid ndcg: 0.021683, valid hitrate: 0.051143
time interval: 23.4048 min
default_0
iter: 40000, train loss: 3.9815, valid recall: 0.023600, valid ndcg: 0.020726, valid hitrate: 0.049844
time interval: 23.8451 min
default_0
iter: 41000, train loss: 3.9688, valid recall: 0.023715, valid ndcg: 0.021085, valid hitrate: 0.051091
time interval: 24.2869 min
default_0
iter: 42000, train loss: 3.9213, valid recall: 0.022708, valid ndcg: 0.020909, valid hitrate: 0.048753
time interval: 24.7344 min
default_0
iter: 43000, train loss: 3.8872, valid recall: 0.023204, valid ndcg: 0.020801, valid hitrate: 0.049740
time interval: 25.1755 min
default_0
iter: 44000, train loss: 3.8644, valid recall: 0.022879, valid ndcg: 0.020828, valid hitrate: 0.048701
time interval: 25.6147 min
default_0
iter: 45000, train loss: 3.8139, valid recall: 0.022501, valid ndcg: 0.020640, valid hitrate: 0.048753
time interval: 26.0548 min
default_0
iter: 46000, train loss: 3.7994, valid recall: 0.021475, valid ndcg: 0.019431, valid hitrate: 0.045530
time interval: 26.4897 min
default_0
iter: 47000, train loss: 3.7645, valid recall: 0.022183, valid ndcg: 0.019808, valid hitrate: 0.046674
time interval: 26.9304 min
default_0
iter: 48000, train loss: 3.7214, valid recall: 0.022075, valid ndcg: 0.019436, valid hitrate: 0.046414
time interval: 27.3677 min
default_0
iter: 49000, train loss: 3.6913, valid recall: 0.021428, valid ndcg: 0.018872, valid hitrate: 0.044802
time interval: 27.8053 min
default_0
iter: 50000, train loss: 3.6738, valid recall: 0.021531, valid ndcg: 0.019230, valid hitrate: 0.044854
time interval: 28.2400 min
default_0
iter: 51000, train loss: 3.6429, valid recall: 0.021389, valid ndcg: 0.019285, valid hitrate: 0.045114
time interval: 28.6812 min
default_0
iter: 52000, train loss: 3.6225, valid recall: 0.021877, valid ndcg: 0.019309, valid hitrate: 0.046466
time interval: 29.1242 min
default_0
iter: 53000, train loss: 3.5953, valid recall: 0.021151, valid ndcg: 0.018706, valid hitrate: 0.044231
time interval: 29.5637 min
default_0
iter: 54000, train loss: 3.6003, valid recall: 0.021394, valid ndcg: 0.019361, valid hitrate: 0.045114
model restored from best_model/default_0/
valid recall: 0.040526, valid ndcg: 0.035442, valid hitrate: 0.077339, valid diversity: 0.000000
test recall: 0.042806, test ndcg: 0.037665, test hitrate: 0.082428, test diversity: 0.000000
